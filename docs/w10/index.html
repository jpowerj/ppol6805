<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeff Jacobs">

<title>Week 10: Evaluating Spatial Hypotheses II: Areal Data – PPOL 6805 / DSAN 6750: GIS for Spatial Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ff63373b1067ca6f91cf1456aa1f00a2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-0d4a9d19931feb4fee1ddab4b2489000.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-ff63373b1067ca6f91cf1456aa1f00a2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="../site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="../site_libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="../site_libs/HomeButton-0.0.1/home-button.js"></script>
<script src="../site_libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="../site_libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="../site_libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="../site_libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" '="" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/dreampulse/computer-modern-web-font@master/fonts.css"><script src="../sidebar.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../dsan-globals/jjstyles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../w10/index.html">Week 10: Oct 29</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">PPOL 6805 / DSAN 6750: GIS for Spatial Data Science</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-house pe-1"></i> Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../writeups/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Writeups</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../final-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final Project</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://hchristy.georgetown.domains/_site" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coding Workshop <i class="bi bi-box-arrow-up-right ps-1" style="font-size: 75%;"></i></span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1: Aug 27</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2: Sep 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3: Sep 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4: Sep 17</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5: Sep 24</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w06/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6: Oct 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w07/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 7: Oct 8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w08/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8: Oct 15</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w09/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 9: Oct 22</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w10/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Week 10: Oct 29</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w11/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 11: Nov 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w12/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 12: Nov 12</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w13/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 13: Nov 19</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w14/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 14: Dec 3</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://georgetown.zoom.us/j/92295251878?pwd=K8nOs3w9uRlj3mfn63bh0yazBpBbsC.1" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Zoom Link <i class="bi bi-box-arrow-up-right ps-1" style="font-size: 75%;"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://georgetown.hosted.panopto.com/Panopto/Pages/Sessions/List.aspx?folderID=20a30444-5d14-4a4e-9994-b34400dc520d" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Recordings <i class="bi bi-box-arrow-up-right ps-1" style="font-size: 75%;"></i></span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://guhub.io" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">JupyterHub <i class="bi bi-box-arrow-up-right ps-1" style="font-size: 75%;"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://jjacobs.me/meet" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Book Office Hour <i class="bi bi-box-arrow-up-right ps-1" style="font-size: 75%;"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://chat.google.com/room/AAQAqBiPrZk?cls=7" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Google Space <i class="bi bi-box-arrow-up-right ps-1 align-self-center justify-self-center" style="font-size: 75%;"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://forms.gle/1qmHmeXo94BaoN7d8" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Feedback <i class="bi bi-box-arrow-up-right ps-1 align-self-center justify-self-center" style="font-size: 75%;"></i></span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p><em>Updated 2025-10-29, 06:27:24 PM</em></p>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#roadmap-to-the-midterm" id="toc-roadmap-to-the-midterm" class="nav-link active" data-scroll-target="#roadmap-to-the-midterm">Roadmap to the Midterm!</a></li>
  <li><a href="#the-point-of-all-this-null-models-via-base-rates" id="toc-the-point-of-all-this-null-models-via-base-rates" class="nav-link" data-scroll-target="#the-point-of-all-this-null-models-via-base-rates">The Point of All This: Null Models via Base Rates!</a>
  <ul class="collapse">
  <li><a href="#null-models" id="toc-null-models" class="nav-link" data-scroll-target="#null-models">Null Models</a></li>
  <li><a href="#constant-risk-hypothesis-motivation" id="toc-constant-risk-hypothesis-motivation" class="nav-link" data-scroll-target="#constant-risk-hypothesis-motivation">Constant Risk Hypothesis: Motivation</a></li>
  <li><a href="#constant-risk-hypothesis-base-rates" id="toc-constant-risk-hypothesis-base-rates" class="nav-link" data-scroll-target="#constant-risk-hypothesis-base-rates">Constant Risk Hypothesis: Base Rates</a></li>
  <li><a href="#meaningful-results-leftrightarrow-comparisons-with-null-models" id="toc-meaningful-results-leftrightarrow-comparisons-with-null-models" class="nav-link" data-scroll-target="#meaningful-results-leftrightarrow-comparisons-with-null-models">Meaningful Results <span class="math inline">\(\leftrightarrow\)</span> <em>Comparisons</em> with Null Model(s)</a></li>
  <li><a href="#example-from-moraga-2024" id="toc-example-from-moraga-2024" class="nav-link" data-scroll-target="#example-from-moraga-2024">Example from Moraga (2024)</a></li>
  <li><a href="#estimating-comparable-intensity-surfaces" id="toc-estimating-comparable-intensity-surfaces" class="nav-link" data-scroll-target="#estimating-comparable-intensity-surfaces">Estimating Comparable Intensity Surfaces</a></li>
  <li><a href="#visualizing-relative-risk-surface" id="toc-visualizing-relative-risk-surface" class="nav-link" data-scroll-target="#visualizing-relative-risk-surface">Visualizing Relative Risk Surface</a></li>
  </ul></li>
  <li><a href="#from-exploratory-to-confirmatory-data-analysis" id="toc-from-exploratory-to-confirmatory-data-analysis" class="nav-link" data-scroll-target="#from-exploratory-to-confirmatory-data-analysis">From Exploratory to Confirmatory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#null-model-csr" id="toc-null-model-csr" class="nav-link" data-scroll-target="#null-model-csr">Null Model: CSR</a></li>
  <li><a href="#the-random-labeling-hypothesis" id="toc-the-random-labeling-hypothesis" class="nav-link" data-scroll-target="#the-random-labeling-hypothesis">The <em>Random Labeling Hypothesis</em></a></li>
  <li><a href="#the-constant-risk-hypothesis" id="toc-the-constant-risk-hypothesis" class="nav-link" data-scroll-target="#the-constant-risk-hypothesis">The <em>Constant Risk Hypothesis</em></a></li>
  </ul></li>
  <li><a href="#point-processes-rightarrow-areal-processes" id="toc-point-processes-rightarrow-areal-processes" class="nav-link" data-scroll-target="#point-processes-rightarrow-areal-processes">Point Processes <span class="math inline">\(\rightarrow\)</span> Areal Processes</a></li>
  <li><a href="#points-rightarrow-areas" id="toc-points-rightarrow-areas" class="nav-link" data-scroll-target="#points-rightarrow-areas">Points <span class="math inline">\(\rightarrow\)</span> Areas</a>
  <ul class="collapse">
  <li><a href="#aggregating-point-processes" id="toc-aggregating-point-processes" class="nav-link" data-scroll-target="#aggregating-point-processes">Aggregating Point Processes</a></li>
  <li><a href="#areal-patterns-aggregated-point-patterns" id="toc-areal-patterns-aggregated-point-patterns" class="nav-link" data-scroll-target="#areal-patterns-aggregated-point-patterns">(1) Areal Patterns = Aggregated Point Patterns</a></li>
  <li><a href="#spatial-scan-statistics" id="toc-spatial-scan-statistics" class="nav-link" data-scroll-target="#spatial-scan-statistics">(2) Spatial Scan Statistics</a></li>
  <li><a href="#hierarchical-bayesian-smoothing" id="toc-hierarchical-bayesian-smoothing" class="nav-link" data-scroll-target="#hierarchical-bayesian-smoothing">(3) Hierarchical Bayesian Smoothing</a></li>
  <li><a href="#autocorrelation-reminder-weight-matrix-defines-neighbors" id="toc-autocorrelation-reminder-weight-matrix-defines-neighbors" class="nav-link" data-scroll-target="#autocorrelation-reminder-weight-matrix-defines-neighbors">Autocorrelation Reminder: Weight Matrix Defines “Neighbors”</a></li>
  <li><a href="#choices-available-in-spdep" id="toc-choices-available-in-spdep" class="nav-link" data-scroll-target="#choices-available-in-spdep">Choices Available in <code>spdep</code></a></li>
  <li><a href="#morans-i-one-more-time" id="toc-morans-i-one-more-time" class="nav-link" data-scroll-target="#morans-i-one-more-time">Moran’s <span class="math inline">\(I\)</span> One More Time</a></li>
  <li><a href="#example-bolshevik-revolution-rightarrow-bipolar-world" id="toc-example-bolshevik-revolution-rightarrow-bipolar-world" class="nav-link" data-scroll-target="#example-bolshevik-revolution-rightarrow-bipolar-world">Example: Bolshevik Revolution <span class="math inline">\(\rightarrow\)</span> “Bipolar” World</a></li>
  </ul></li>
  <li><a href="#spatial-regression" id="toc-spatial-regression" class="nav-link" data-scroll-target="#spatial-regression">Spatial Regression</a>
  <ul class="collapse">
  <li><a href="#motivation-when-does-non-spatial-regression-work" id="toc-motivation-when-does-non-spatial-regression-work" class="nav-link" data-scroll-target="#motivation-when-does-non-spatial-regression-work">Motivation: When Does Non-Spatial Regression “Work”?</a></li>
  <li><a href="#spatial-autocorrelation-in-residuals" id="toc-spatial-autocorrelation-in-residuals" class="nav-link" data-scroll-target="#spatial-autocorrelation-in-residuals">Spatial Autocorrelation in Residuals</a></li>
  <li><a href="#example-italian-elections" id="toc-example-italian-elections" class="nav-link" data-scroll-target="#example-italian-elections">Example: Italian Elections</a></li>
  <li><a href="#will-ols-work-here" id="toc-will-ols-work-here" class="nav-link" data-scroll-target="#will-ols-work-here">Will OLS “Work” Here?</a></li>
  <li><a href="#what-does-it-mean-that-spatial-effect-is-significant" id="toc-what-does-it-mean-that-spatial-effect-is-significant" class="nav-link" data-scroll-target="#what-does-it-mean-that-spatial-effect-is-significant">What Does it Mean that “Spatial Effect” is Significant?</a></li>
  <li><a href="#case-1-no-residual-spatial-autocorrelation" id="toc-case-1-no-residual-spatial-autocorrelation" class="nav-link" data-scroll-target="#case-1-no-residual-spatial-autocorrelation">Case 1: No Residual Spatial Autocorrelation</a></li>
  <li><a href="#case-2-conditional-autoregressive-model-car" id="toc-case-2-conditional-autoregressive-model-car" class="nav-link" data-scroll-target="#case-2-conditional-autoregressive-model-car">Case 2: Conditional Autoregressive Model (CAR)</a></li>
  <li><a href="#case-3-simultaneous-autoregressive-model-sar" id="toc-case-3-simultaneous-autoregressive-model-sar" class="nav-link" data-scroll-target="#case-3-simultaneous-autoregressive-model-sar">Case 3: Simultaneous Autoregressive Model (SAR)</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jpowerj/ppol6805/blob/main/w10/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 10: Evaluating Spatial Hypotheses II: Areal Data</h1>
<p class="subtitle lead"><em>PPOL 6805 / DSAN 6750: GIS for Spatial Data Science</em><br>Fall 2025</p>
  <div class="quarto-categories">
    <div class="quarto-category">Class Sessions</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Jeff Jacobs </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="mailto:jj1088@georgetown.edu" target="_blank"><code>jj1088@georgetown.edu</code></a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Wednesday, October 29, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<center class="mb-3">
<a class="h2" href="./slides.html" target="_blank">Open slides in new tab →</a>
</center>
<section id="roadmap-to-the-midterm" class="level1 text-80">
<h1 class="text-80">Roadmap to the Midterm!</h1>
<ul>
<li>Last Week (<strong>Oct 22</strong>): Evaluating Hypotheses for <strong>Point Data</strong></li>
<li>Today (<strong>Oct 29</strong>): Evaluating Hypotheses for <strong>Areal Data</strong></li>
<li>In-Class Midterm (<strong>Nov 5</strong>): Basically a “mini-homework” on Spatial Data Science unit (same topics as on HW3)!</li>
</ul>
<div class="hidden">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../dsan-globals/_globals.r"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6805</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mdthemes) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</section>
<section id="the-point-of-all-this-null-models-via-base-rates" class="level1" data-stack-name="Base Rates">
<h1 data-stack-name="Base Rates">The Point of All This: Null Models via Base Rates!</h1>
<section id="null-models" class="level2">
<h2 class="anchored" data-anchor-id="null-models">Null Models</h2>
<ul>
<li>Given an <strong>intensity function</strong>, we can compute a bunch of simulated <strong>point patterns</strong> (<strong>in</strong>homogeneous Poisson Point Process)…</li>
<li>How does an <strong>observed</strong> point pattern <strong>differ</strong> from the simulated point patterns?</li>
</ul>
</section>
<section id="constant-risk-hypothesis-motivation" class="level2 smaller crunch-title">
<h2 class="smaller crunch-title anchored" data-anchor-id="constant-risk-hypothesis-motivation">Constant Risk Hypothesis: Motivation</h2>
<ul>
<li>Here is a (fictional) map of flu cases in the US “Midwest”</li>
<li>Are people in Chicago and Detroit equally “at risk”?</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>city_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>city, <span class="sc">~</span>lon, <span class="sc">~</span>lat, <span class="sc">~</span>pop,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Chicago"</span>, <span class="fl">41.950567516553896</span>, <span class="sc">-</span><span class="fl">87.93011127491978</span>, <span class="dv">2746388</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Detroit"</span>, <span class="fl">42.45123004999075</span>, <span class="sc">-</span><span class="fl">83.18402319217698</span>, <span class="dv">631524</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>city_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  city_df,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lat"</span>, <span class="st">"lon"</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">crs=</span><span class="dv">4326</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>city_buf_sf <span class="ot">&lt;-</span> city_sf <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_buffer</span>(<span class="dv">20000</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>city_cases_sf <span class="ot">&lt;-</span> city_buf_sf <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_sample</span>(<span class="at">size=</span><span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">2</span>)) <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>city_cases_sf<span class="sc">$</span>city <span class="ot">&lt;-</span> <span class="st">"Detroit (10 Cases)"</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>city_cases_sf[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="st">'city'</span>] <span class="ot">&lt;-</span> <span class="st">"Chicago (10 Cases)"</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>city_cases_sf<span class="sc">$</span>sample <span class="ot">&lt;-</span> <span class="st">"Flu"</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(city_cases_sf, <span class="at">zcol=</span><span class="st">"city"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-e8acf1ea5b195e64e0be" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e8acf1ea5b195e64e0be">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[41.92782062445267,41.90331047626422,42.10943968571632,41.90995812895028,41.83957719080497,41.84407460558649,41.88571806552584,42.04287141370695,41.9917448143671,41.93063076006005,42.56600954859916,42.37250379313623,42.43864908488637,42.37905622699538,42.61088502767679,42.5960630444532,42.41046788743309,42.4507552074192,42.6126007586253,42.36489287565474],[-88.11246839720616,-87.86386477539548,-87.92010835714338,-87.80847310178835,-87.91081596369123,-87.92171224862267,-88.09004018209288,-88.09165913850197,-88.06738022952226,-87.69383129929145,-83.02432589918483,-83.24639833291329,-83.3325958322951,-83.22018512667044,-83.16824463885693,-83.30785764703327,-83.16283475416196,-83.36983975908694,-83.17808466649088,-83.1124782945238],6,null,"city_cases_sf - city",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":["#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333"],"fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6]},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Chicago (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>11&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>12&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>13&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>14&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>15&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>16&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>17&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>18&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>19&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>20&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>2<\/td><th>city&emsp;<\/th><td>Detroit (10 Cases)&emsp;<\/td><\/tr><tr><td>3<\/td><th>sample&emsp;<\/th><td>Flu&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["Chicago (10 Cases)","Chicago (10 Cases)","Chicago (10 Cases)","Chicago (10 Cases)","Chicago (10 Cases)","Chicago (10 Cases)","Chicago (10 Cases)","Chicago (10 Cases)","Chicago (10 Cases)","Chicago (10 Cases)","Detroit (10 Cases)","Detroit (10 Cases)","Detroit (10 Cases)","Detroit (10 Cases)","Detroit (10 Cases)","Detroit (10 Cases)","Detroit (10 Cases)","Detroit (10 Cases)","Detroit (10 Cases)","Detroit (10 Cases)"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-88.11246839720616,41.83957719080497,-83.02432589918483,42.6126007586253,true,"city_cases_sf - city","Zoom to city_cases_sf - city","<strong> city_cases_sf - city <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"city_cases_sf - city",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#4B0055","#FDE333"],"labels":["Chicago (10 Cases)","Detroit (10 Cases)"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"city_cases_sf - city","extra":null,"layerId":null,"className":"info legend","group":"city_cases_sf - city"}]}],"limits":{"lat":[41.83957719080497,42.6126007586253],"lng":[-88.11246839720616,-83.02432589918483]},"fitBounds":[41.83957719080497,-88.11246839720616,42.6126007586253,-83.02432589918483,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
</section>
<section id="constant-risk-hypothesis-base-rates" class="level2 smaller crunch-title">
<h2 class="smaller crunch-title anchored" data-anchor-id="constant-risk-hypothesis-base-rates">Constant Risk Hypothesis: Base Rates</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Chicago</th>
<th>Detroit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Population</strong></td>
<td>2,746,388</td>
<td>631,524</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet.extras2) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>city_pop_sf <span class="ot">&lt;-</span> city_buf_sf <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_sample</span>(<span class="at">size=</span><span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">4</span>)) <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>city_pop_sf<span class="sc">$</span>city <span class="ot">&lt;-</span> <span class="st">"Detroit"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>city_pop_sf[<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="st">'city'</span>] <span class="ot">&lt;-</span> <span class="st">"Chicago"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>city_pop_sf<span class="sc">$</span>sample <span class="ot">&lt;-</span> <span class="st">"People"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>city_combined_sf <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(city_cases_sf, city_pop_sf)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mapview(city_combined_sf, zcol="city", marker="sample")</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>Flu <span class="ot">=</span> <span class="fu">makeIcon</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Maki2-danger-24.svg/240px-Maki2-danger-24.svg.png"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Maki2-danger-24.svg/24px-Maki2-danger-24.svg.png"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">20</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">20</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>People <span class="ot">=</span> <span class="fu">makeIcon</span>(</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Maki2-pitch-24.svg/24px-Maki2-pitch-24.svg.png"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Maki2-pitch-24.svg/24px-Maki2-pitch-24.svg.png"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">20</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">20</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>city_combined_sf<span class="sc">$</span>r <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(city_combined_sf<span class="sc">$</span>sample <span class="sc">==</span> <span class="st">"Flu"</span>, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>city_flu_sf <span class="ot">&lt;-</span> city_combined_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Flu"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>city_ppl_sf <span class="ot">&lt;-</span> city_combined_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"People"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(city_flu_sf) <span class="sc">|&gt;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">"CartoDB.Positron"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">data=</span>city_flu_sf, <span class="at">icon =</span> Flu) <span class="sc">|&gt;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">data=</span>city_ppl_sf, <span class="at">icon =</span> People)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-7aa4ad290f7da5240730" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7aa4ad290f7da5240730">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[[41.92782062445267,41.90331047626422,42.10943968571632,41.90995812895028,41.83957719080497,41.84407460558649,41.88571806552584,42.04287141370695,41.9917448143671,41.93063076006005,42.56600954859916,42.37250379313623,42.43864908488637,42.37905622699538,42.61088502767679,42.5960630444532,42.41046788743309,42.4507552074192,42.6126007586253,42.36489287565474],[-88.11246839720616,-87.86386477539548,-87.92010835714338,-87.80847310178835,-87.91081596369123,-87.92171224862267,-88.09004018209288,-88.09165913850197,-88.06738022952226,-87.69383129929145,-83.02432589918483,-83.24639833291329,-83.3325958322951,-83.22018512667044,-83.16824463885693,-83.30785764703327,-83.16283475416196,-83.36983975908694,-83.17808466649088,-83.1124782945238],{"iconUrl":{"data":"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Maki2-danger-24.svg/240px-Maki2-danger-24.svg.png","index":0},"iconRetinaUrl":{"data":"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Maki2-danger-24.svg/24px-Maki2-danger-24.svg.png","index":0},"iconWidth":20,"iconHeight":20},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[42.07003042164815,42.01671318393819,41.91432177037768,41.9479024239325,41.9463415097141,41.88010061598432,41.79047995784255,41.99081658607848,42.00381246234248,41.9951495471355,42.06373130013085,42.02374224403648,42.01541872878101,41.91857234666215,41.81867949367321,41.90189736454267,42.41897620351784,42.51779389949037,42.47424869984425,42.4346134291075],[-87.97649062565371,-87.76743063538795,-88.16371914148617,-87.71355929970649,-87.86951122067572,-87.96379807356766,-87.87274864407634,-87.7846171249432,-88.09769051085306,-87.82519267570265,-87.87986071116882,-88.03335762896566,-87.81062089075186,-87.70003617846898,-87.94999829411655,-87.91114066652594,-83.03103451269098,-83.05076520845101,-83.20776451373997,-83.17136120133367],{"iconUrl":{"data":"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Maki2-pitch-24.svg/24px-Maki2-pitch-24.svg.png","index":0},"iconRetinaUrl":{"data":"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Maki2-pitch-24.svg/24px-Maki2-pitch-24.svg.png","index":0},"iconWidth":20,"iconHeight":20},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[41.79047995784255,42.6126007586253],"lng":[-88.16371914148617,-83.02432589918483]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="meaningful-results-leftrightarrow-comparisons-with-null-models" class="level2 crunch-title title-10 smaller">
<h2 class="crunch-title title-10 smaller anchored" data-anchor-id="meaningful-results-leftrightarrow-comparisons-with-null-models">Meaningful Results <span class="math inline">\(\leftrightarrow\)</span> <em>Comparisons</em> with Null Model(s)</h2>
<ul>
<li><p><strong>Cases</strong> of disease form an intensity function <span class="math inline">\(\lambda(\mathbf{s})\)</span></p></li>
<li><p><strong>Controls</strong> form an “ambient” intensity function <span class="math inline">\(\lambda_0(\mathbf{s})\)</span></p></li>
<li><p><span class="math inline">\(\implies\)</span> The following model allows us to separate the quantities we <strong>really</strong> care about from the <strong>base rate</strong> information:</p>
<p><span class="math display">\[
  \lambda(\mathbf{s}) = \alpha \overbrace{\lambda_0(\mathbf{s})}^{\mathclap{\text{Base Rate}}} \underbrace{\rho(\mathbf{s})}_{\mathclap{\text{Relative Risk}}},
  \]</span></p>
<p>where</p>
<p><span class="math display">\[
  \alpha = \frac{\# \text{Cases}}{\# \text{Controls}}
  \]</span></p></li>
<li><p>(Remember: <strong>unit</strong> of <span class="math inline">\(\lambda(\mathbf{s})\)</span> is <strong>number of cases</strong>; <strong>not</strong> a probability density!)</p></li>
</ul>
</section>
<section id="example-from-moraga-2024" class="level2 smaller crunch-title crunch-ul crunch-quarto-figure text-65">
<h2 class="smaller crunch-title crunch-ul crunch-quarto-figure text-65 anchored" data-anchor-id="example-from-moraga-2024">Example from Moraga (2024)</h2>
<ul>
<li><a href="https://tilmandavies.github.io/sparr/reference/pbc.html" target="_blank">Data</a>: 761 <a href="https://pubmed.ncbi.nlm.nih.gov/11731995/" target="_blank">primary biliary cirrhosis (PBC) cases</a>, 3020 controls, England 1987-94</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center" data-crop="true">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparr) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(pbc)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>controls <span class="ot">&lt;-</span> <span class="fu">unmark</span>(pbc[<span class="fu">which</span>(pbc<span class="sc">$</span>marks <span class="sc">==</span> <span class="st">"control"</span>), ])</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>controls <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>() <span class="sc">|&gt;</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Controls (Population Sample)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/plot-raw-controls-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="288"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center" data-crop="true">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">&lt;-</span> <span class="fu">unmark</span>(pbc[<span class="fu">which</span>(pbc<span class="sc">$</span>marks <span class="sc">==</span> <span class="st">"case"</span>), ])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>cases <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>() <span class="sc">|&gt;</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"PBC Cases"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/plot-raw-cases-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="288"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="estimating-comparable-intensity-surfaces" class="level2 title-11 crunch-title smaller crunch-details crunch-p crunch-ul crunch-img">
<h2 class="title-11 crunch-title smaller crunch-details crunch-p crunch-ul crunch-img anchored" data-anchor-id="estimating-comparable-intensity-surfaces">Estimating Comparable Intensity Surfaces</h2>
<ul>
<li>To ensure comparable <strong>intensity functions</strong>, need a common <strong>bandwidth</strong> value</li>
<li><code>density()</code> from <code>spatstat</code> makes “smart” choices for this bandwidth, so for now we just <strong>average</strong> the bandwidths estimated for cases and controls:</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(pbc)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">&lt;-</span> <span class="fu">unmark</span>(pbc[<span class="fu">which</span>(pbc<span class="sc">$</span>marks <span class="sc">==</span> <span class="st">"case"</span>), ])</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>controls <span class="ot">&lt;-</span> <span class="fu">unmark</span>(pbc[<span class="fu">which</span>(pbc<span class="sc">$</span>marks <span class="sc">==</span> <span class="st">"control"</span>), ])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>bwcases <span class="ot">&lt;-</span> <span class="fu">attr</span>(<span class="fu">density</span>(cases), <span class="st">"sigma"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>bwcontr <span class="ot">&lt;-</span> <span class="fu">attr</span>(<span class="fu">density</span>(controls), <span class="st">"sigma"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>(bw <span class="ot">&lt;-</span> (bwcases <span class="sc">+</span> bwcontr)<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.45837</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>int_controls <span class="ot">&lt;-</span> <span class="fu">density</span>(controls, <span class="at">sigma =</span> bw, <span class="at">eps=</span><span class="fl">0.25</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(int_controls, <span class="at">main =</span> <span class="st">"Control Intensity"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/plot-controls-density-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="288"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center" data-crop="true">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>int_cases <span class="ot">&lt;-</span> <span class="fu">density</span>(cases, <span class="at">sigma =</span> bw, <span class="at">eps=</span><span class="fl">0.25</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(int_cases, <span class="at">main =</span> <span class="st">"Case Intensity"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/plot-cases-density-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="288"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="visualizing-relative-risk-surface" class="level2 smaller crunch-title crunch-ul">
<h2 class="smaller crunch-title crunch-ul anchored" data-anchor-id="visualizing-relative-risk-surface">Visualizing Relative Risk Surface</h2>
<ul>
<li>All that’s left is <span class="math inline">\(\alpha = \# \text{Controls} / \# \text{Cases}\)</span>!</li>
</ul>
<div class="cell" data-layout-align="center" data-crop="true">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fields)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spam</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Spam version 2.10-0 (2023-10-23) is loaded.
Type 'help( Spam)' or 'demo( spam)' for a short introduction 
and overview of this package.
Help for individual functions is also obtained by adding the
suffix '.spam' to the function name, e.g. 'help( chol.spam)'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'spam'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    backsolve, forwardsolve</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: viridisLite</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Try help(fields) to get started.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'fields'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:leaflet':

    addLegend</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(alpha_hat <span class="ot">&lt;-</span> cases<span class="sc">$</span>n<span class="sc">/</span>controls<span class="sc">$</span>n)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2519868</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> int_cases<span class="sc">$</span>xcol</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> int_cases<span class="sc">$</span>yrow</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>rr <span class="ot">&lt;-</span> <span class="fu">t</span>(int_cases<span class="sc">$</span>v)<span class="sc">/</span><span class="fu">t</span>(alpha_hat <span class="sc">*</span> int_controls<span class="sc">$</span>v)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">image.plot</span>(x, y, rr, <span class="at">asp =</span> <span class="dv">1</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">xlab =</span> <span class="st">"Easting"</span>, <span class="at">ylab =</span> <span class="st">"Northing"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cases-controls-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="from-exploratory-to-confirmatory-data-analysis" class="level1 smaller title-10 not-title-slide crunch-title" data-stack-name="Evaluation">
<h1 class="smaller title-10 not-title-slide crunch-title" data-stack-name="Evaluation">From Exploratory to Confirmatory Data Analysis</h1>
<ul>
<li>How do we know whether ↑ risk around <strong>North Newcastle</strong> due to “chance”? Maybe relative risk is actually constant, and people in Newcastle are just <strong>unlucky</strong>…</li>
<li>Thought experiment: Bro hands you a coin. You flip <strong>10 times</strong>. <code>HHHHHTHHHH</code>…</li>
<li>Coin <strong>may</strong> be biased-towards-<code>H</code>, <strong>or</strong> could be <strong>fair</strong> (lots of heads <strong>by chance!</strong>)</li>
<li><strong>Stats</strong>: Compare with <strong>null model!</strong> For fair coin, how <strong>likely</strong> is [9 Heads / 10 Flips]?</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tukey.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption><strong>Exploratory</strong> Data Analysis: Collecting <strong>evidence</strong></figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/judgement.jpg" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption><strong>Confirmatory</strong> Data Analysis: Making <strong>judgements</strong></figcaption>
</figure>
</div>
</div>
</div>
<section id="null-model-csr" class="level2">
<h2 class="anchored" data-anchor-id="null-model-csr">Null Model: CSR</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IRP_CSR.png" class="img-fluid figure-img"></p>
<figcaption>Figure from <span class="citation" data-cites="gimond_introduction_2024">Gimond (<a href="#ref-gimond_introduction_2024" role="doc-biblioref">2024</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="the-random-labeling-hypothesis" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="the-random-labeling-hypothesis">The <em>Random Labeling Hypothesis</em></h2>
<div style="width: 100%;">
<ul>
<li>Randomly apply 761 “sick” labels to the 3781 points!</li>
</ul>
</div>
<div class="columns">
<div class="column" style="width:33%;">
<div class="cell" data-layout-align="center" data-crop="true">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plot_rlabel <span class="ot">&lt;-</span> <span class="cf">function</span>(rl_ppp) {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  rl_win_sf <span class="ot">&lt;-</span> <span class="fu">window_to_sf</span>(rl_ppp)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  rl_points_sf <span class="ot">&lt;-</span> <span class="fu">points_to_sf</span>(rl_ppp) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> spatstat.geom..marks.x.</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  rl_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>rl_win_sf,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha=</span><span class="fl">0.3</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">fill=</span>type, <span class="at">alpha=</span>type),</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>rl_points_sf,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">size=</span><span class="dv">2</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># alpha=0.75,</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape=</span><span class="dv">21</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">stroke=</span><span class="fl">0.1</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color='white',</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_color_manual(</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   "Point Type",</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   values=c("control"="gray","case"=cb_palette[1])</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ) +</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Type"</span>,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">values=</span><span class="fu">c</span>(<span class="st">"control"</span><span class="ot">=</span><span class="st">"gray"</span>,<span class="st">"case"</span><span class="ot">=</span>cb_palette[<span class="dv">1</span>])</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_manual</span>(</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Type"</span>,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">values=</span><span class="fu">c</span>(<span class="st">"control"</span><span class="ot">=</span><span class="fl">0.5</span>, <span class="st">"case"</span><span class="ot">=</span><span class="fl">1.0</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span><span class="st">"NE Britain Disease Cases"</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rl_plot)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6810</span>)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>rl1_ppp <span class="ot">&lt;-</span> <span class="fu">rlabel</span>(pbc)</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_rlabel</span>(rl1_ppp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/random-labeling-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="460"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6811</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pbc_2 <span class="ot">&lt;-</span> <span class="fu">rlabel</span>(pbc)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_rlabel</span>(pbc_2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/random-labeling-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="460"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6812</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>pbc_3 <span class="ot">&lt;-</span> <span class="fu">rlabel</span>(pbc)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_rlabel</span>(pbc_3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/random-labeling-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="460"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="the-constant-risk-hypothesis" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="the-constant-risk-hypothesis">The <em>Constant Risk Hypothesis</em></h2>
<ul>
<li>Everyone <strong>equally at risk</strong> of contracting disease, <strong>regardless</strong> of location: <span class="math inline">\(\rho(\mathbf{s}) = 1\)</span></li>
<li>In this case: <span class="math inline">\(\lambda_{CR}(\mathbf{s}) = \alpha \lambda_0(\mathbf{s})\)</span></li>
</ul>
<div class="columns">
<div class="column" style="width:33%;">
<div class="cell" data-layout-align="center" data-crop="true">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pbc_win_sf <span class="ot">&lt;-</span> pbc <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>() <span class="sc">|&gt;</span> <span class="fu">filter</span>(label <span class="sc">==</span> <span class="st">"window"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plot_pbc_sim <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    pbc_sim <span class="ot">&lt;-</span> spatstat.random<span class="sc">::</span><span class="fu">rpoispp</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">lambda =</span> alpha_hat <span class="sc">*</span> int_controls</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Separate window and points</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    pbc_sf <span class="ot">&lt;-</span> pbc_sim <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    pbc_point_sf <span class="ot">&lt;-</span> pbc_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(label <span class="sc">==</span> <span class="st">"point"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    pbc_win_sf <span class="ot">&lt;-</span> pbc_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(label <span class="sc">==</span> <span class="st">"window"</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    pbc_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_sf</span>(<span class="at">data=</span>pbc_win_sf) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_sf</span>(<span class="at">data=</span>pbc_point_sf, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(pbc_plot)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pbc_sim</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/monte-carlo-sim-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="240"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-layout-align="center" data-crop="true">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pbc_sim</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="240"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-layout-align="center" data-crop="true">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pbc_sim</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="240"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="point-processes-rightarrow-areal-processes" class="level1">
<h1>Point Processes <span class="math inline">\(\rightarrow\)</span> Areal Processes</h1>
<ul>
<li>The “Complete” Part of Complete Spatial Randomness (CSR)</li>
<li>Bringing <strong>Neighbors</strong> Back In</li>
<li>Spatial Regression</li>
</ul>
</section>
<section id="points-rightarrow-areas" class="level1" data-stack-name="Points → Areas">
<h1 data-stack-name="Points → Areas">Points <span class="math inline">\(\rightarrow\)</span> Areas</h1>
<section id="aggregating-point-processes" class="level2">
<h2 class="anchored" data-anchor-id="aggregating-point-processes">Aggregating Point Processes</h2>
<ul>
<li>Recall the <strong>two</strong> “stages” of our Poisson-based point processes
<ul>
<li>A <strong>Poisson</strong>-distributed number of points, then</li>
<li><strong>Uniformly</strong>-distributed coordinates for each point</li>
</ul></li>
<li>One way to see <strong>areal</strong> data modeling: we <em>keep</em> the Poisson part, but we <strong>no longer observe</strong> the coordinates for the points!</li>
<li>So… why is it still helpful for you to have sat through those lectures on Point Processes? Two reasons…</li>
</ul>
</section>
<section id="areal-patterns-aggregated-point-patterns" class="level2 title-09 crunch-title text-90">
<h2 class="title-09 crunch-title text-90 anchored" data-anchor-id="areal-patterns-aggregated-point-patterns">(1) Areal Patterns = Aggregated Point Patterns</h2>
<ul>
<li>One application, mentioned last week: <strong>areal-weighted interpolation</strong> using actual <strong>models</strong> of how the points are distributed within the area!</li>
<li>Regularly-spaced points is rarely a good “default” model!</li>
<li>Humans, for example, rarely live at perfect evenly-spaced intervals… they form <strong>households</strong>, <strong>villages</strong>, <strong>cities</strong></li>
<li>Regularly-spaced points (we now know) <span class="math inline">\(\implies\)</span> <strong>negative autocorrelation</strong> <span class="math inline">\(\implies\)</span> typically due to <strong>inhibition process</strong> (competition)</li>
</ul>
</section>
<section id="spatial-scan-statistics" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="spatial-scan-statistics">(2) Spatial Scan Statistics</h2>
<ul>
<li>Areal regions often the result of <strong>artificial</strong> / “arbitrary” human divisions
<ul>
<li>(Particulate matter doesn’t pass through customs)</li>
</ul></li>
<li><span class="math inline">\(\implies\)</span> If we care about processes which don’t “adhere to” borders (like disease spread), we want to “scan” <strong>buffers</strong> around points regardless of areal borders</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/scan_stat.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="hierarchical-bayesian-smoothing" class="level2 title-08 crunch-title crunch-ul">
<h2 class="title-08 crunch-title crunch-ul anchored" data-anchor-id="hierarchical-bayesian-smoothing">(3) Hierarchical Bayesian Smoothing</h2>
<ul>
<li>The issue might just be <strong>not enough data</strong> for some areas, while we have an <strong>abundance</strong> of data in nearby areas…</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/bayes_smoothing.png" class="img-fluid figure-img"></p>
<figcaption>From Kramer (2023), <a href="https://mkram01.github.io/EPI563-SpatialEPI/disease-mapping-iii-introduction-to-fully-bayesian-mapping.html" target="_blank"><em>Spatial Epidemiology</em></a></figcaption>
</figure>
</div>
</section>
<section id="autocorrelation-reminder-weight-matrix-defines-neighbors" class="level2 smaller crunch-title title-10">
<h2 class="smaller crunch-title title-10 anchored" data-anchor-id="autocorrelation-reminder-weight-matrix-defines-neighbors">Autocorrelation Reminder: Weight Matrix Defines “Neighbors”</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/canada_dist.gif" class="img-fluid figure-img"></p>
<figcaption>From <a href="http://www.canadianrockies.net/maps/" target="_blank">Canadian Rockies Exploration Guide</a></figcaption>
</figure>
</div>
</section>
<section id="choices-available-in-spdep" class="level2 crunch-title text-90 inline-90">
<h2 class="crunch-title text-90 inline-90 anchored" data-anchor-id="choices-available-in-spdep">Choices Available in <code>spdep</code></h2>
<ul>
<li><span class="math inline">\(w_{ij} = 1\)</span> if <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> “touch”
<ul>
<li>Rook: Overlap is 1 or 2-dimensional</li>
<li>Queen: Overlap is 0, 1, or 2-dimensional</li>
</ul></li>
<li><span class="math inline">\(w_{ij} = \frac{1}{\text{dist}(i, j)}\)</span>
<ul>
<li><span class="math inline">\(w(\textsf{Seoul}, \textsf{Incheon})\)</span> &gt; <span class="math inline">\(w(\textsf{Seoul}, \textsf{Busan})\)</span> &gt; <span class="math inline">\(w(\textsf{Seoul}, \textsf{Jeju})\)</span></li>
</ul></li>
<li><span class="math inline">\(w_{ij} = 1\)</span> if <span class="math inline">\(dist(i, j) &lt; \overline{D}\)</span></li>
<li><span class="math inline">\(w_{ij} = 1\)</span> for <span class="math inline">\(K\)</span> nearest neighbors</li>
</ul>
</section>
<section id="morans-i-one-more-time" class="level2">
<h2 class="anchored" data-anchor-id="morans-i-one-more-time">Moran’s <span class="math inline">\(I\)</span> One More Time</h2>
<ul>
<li>Round 1 (Week 6): Moran’s <span class="math inline">\(I\)</span> as “thermometer”</li>
<li>Round 2 (Today): Could an <span class="math inline">\(I\)</span> value this extreme occur due to random noise?</li>
</ul>
</section>
<section id="example-bolshevik-revolution-rightarrow-bipolar-world" class="level2">
<h2 class="anchored" data-anchor-id="example-bolshevik-revolution-rightarrow-bipolar-world">Example: Bolshevik Revolution <span class="math inline">\(\rightarrow\)</span> “Bipolar” World</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/democracy.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<ul>
<li>Null hypothesis: no spatial effect of democratization/de-democratization on neighboring countries</li>
<li>If null hypothesis is true, and countries democratize/de-democratize independently… could this pattern still arise?</li>
</ul>
</section>
</section>
<section id="spatial-regression" class="level1" data-stack-name="Spatial Regression">
<h1 data-stack-name="Spatial Regression">Spatial Regression</h1>
<ul>
<li>(We made it! This is the last Spatial Data Science topic!)</li>
<li>(Nearly all extremely-fancy applied GIS models can be implemented via Spatial Regression!)</li>
</ul>
<section id="motivation-when-does-non-spatial-regression-work" class="level2">
<h2 class="anchored" data-anchor-id="motivation-when-does-non-spatial-regression-work">Motivation: When Does Non-Spatial Regression “Work”?</h2>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1X_{i,1} + \beta_2X_{i,2} + \cdots + \beta_MX_{i,M} + \varepsilon_i
\]</span></p>
<ul>
<li><p>Importance of OLS regression: can give us the <strong>Best Linear Unbiased Estimator (BLUE)</strong></p></li>
<li><p>This is only true <strong>if</strong> the Gauss-Markov assumptions hold—one of these is that the error terms are <strong>uncorrelated</strong>:</p>
<p><span class="math display">\[
\text{Cov}[\varepsilon_i, \varepsilon_j] = 0 \; \forall i \neq j
\]</span></p></li>
</ul>
</section>
<section id="spatial-autocorrelation-in-residuals" class="level2">
<h2 class="anchored" data-anchor-id="spatial-autocorrelation-in-residuals">Spatial Autocorrelation in Residuals</h2>
<ul>
<li>We have now seen several models / datasets where effect of some variable <span class="math inline">\(X\)</span> (say, population) on another variable <span class="math inline">\(Y\)</span> (say, disease count) is <strong>spatial</strong>! (Kind of the whole point of the class 😜)</li>
<li>So, to see when OLS will “work”, vs.&nbsp;when you need to incorporate GIS, key step is <strong>plotting the spatial distribution of regression residuals!</strong></li>
</ul>
</section>
<section id="example-italian-elections" class="level2">
<h2 class="anchored" data-anchor-id="example-italian-elections">Example: Italian Elections</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/italy_gdp.svg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption><span class="citation" data-cites="ward_spatial_2018">Ward and Gleditsch (<a href="#ref-ward_spatial_2018" role="doc-biblioref">2018</a>)</span>, Figure 2.3</figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/italy_turnout.svg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption><span class="citation" data-cites="ward_spatial_2018">Ward and Gleditsch (<a href="#ref-ward_spatial_2018" role="doc-biblioref">2018</a>)</span>, Figure 2.4</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="will-ols-work-here" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="will-ols-work-here">Will OLS “Work” Here?</h2>
<ul>
<li>Can we use OLS to derive the BLUE of the effect of GDP on voting?</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<center>
Plain OLS
</center>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(N = 477\)</span></th>
<th><span class="math inline">\(\widehat{\beta}\)</span></th>
<th>SE</th>
<th><span class="math inline">\(t\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>35.30</td>
<td>2.21</td>
<td>15.96</td>
</tr>
<tr class="even">
<td>Log GDP per cap</td>
<td>13.46</td>
<td>0.65</td>
<td>20.84</td>
</tr>
</tbody>
</table>
<p>Moran’s <span class="math inline">\(I\)</span> for residuals = <strong>0.47</strong>(!)</p>
</div><div class="column" style="width:4%;">
<p>&nbsp;</p>
</div><div class="column" style="width:48%;">
<center>
Spatial Regression
</center>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(N = 477\)</span></th>
<th><span class="math inline">\(\widehat{\beta}\)</span></th>
<th>SE</th>
<th><span class="math inline">\(t\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>4.70</td>
<td>1.66</td>
<td>2.80</td>
</tr>
<tr class="even">
<td>Log GDP per cap</td>
<td>1.77</td>
<td>0.48</td>
<td>3.66</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\rho\)</span></td>
<td>0.87</td>
<td>0.02</td>
<td>36.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="what-does-it-mean-that-spatial-effect-is-significant" class="level2">
<h2 class="anchored" data-anchor-id="what-does-it-mean-that-spatial-effect-is-significant">What Does it Mean that “Spatial Effect” is Significant?</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/italy_effect.svg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption><span class="citation" data-cites="ward_spatial_2018">Ward and Gleditsch (<a href="#ref-ward_spatial_2018" role="doc-biblioref">2018</a>)</span>, Figure 2.5</figcaption>
</figure>
</div>
</section>
<section id="case-1-no-residual-spatial-autocorrelation" class="level2">
<h2 class="anchored" data-anchor-id="case-1-no-residual-spatial-autocorrelation">Case 1: No Residual Spatial Autocorrelation</h2>
<ul>
<li>Example: Residuals have Moran’s <span class="math inline">\(I\)</span> near 0…</li>
<li>…Don’t need GIS at all!</li>
</ul>
</section>
<section id="case-2-conditional-autoregressive-model-car" class="level2">
<h2 class="anchored" data-anchor-id="case-2-conditional-autoregressive-model-car">Case 2: Conditional Autoregressive Model (CAR)</h2>
<ul>
<li>GIS, but… only for “fixing” your regression</li>
</ul>
<p><span class="math display">\[
Y_i = \underbrace{\mu_i}_{\text{Non-spatial model}} + \underbrace{\frac{1}{w_{i,cdot}}\sum_{j \neq i}(Y_j - \mu_j)}_{\text{Spatial Autocorrelation}} + \varepsilon_i
\]</span></p>
</section>
<section id="case-3-simultaneous-autoregressive-model-sar" class="level2">
<h2 class="anchored" data-anchor-id="case-3-simultaneous-autoregressive-model-sar">Case 3: Simultaneous Autoregressive Model (SAR)</h2>
<ul>
<li>The main event! Here we are <strong>explicitly</strong> modeling “spatially lagged” versions of our dependent variable <span class="math inline">\(Y\)</span>!</li>
</ul>
<p><span class="math display">\[
Y = \mathbf{X}\beta + \rho \underbrace{\mathbf{W}Y}_{\mathclap{\text{Spatially-lagged }Y}} + \boldsymbol\varepsilon
\]</span></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-gimond_introduction_2024" class="csl-entry" role="listitem">
Gimond, Manuel. 2024. <em><a href="https://mgimond.github.io/Spatial/">Introduction to <span>GIS</span> and <span>Spatial Analysis</span></a></em>. Colby College (ES214).
</div>
<div id="ref-ward_spatial_2018" class="csl-entry" role="listitem">
Ward, Michael D., and Kristian Skrede Gleditsch. 2018. <em><a href="https://www.dropbox.com/scl/fi/1hxzqcn9e1a5fntw8iqvk/Spatial-Regression-Models.pdf?rlkey=edeow7y9l1l0c8e8xhq8nxldf&amp;dl=1">Spatial <span>Regression Models</span></a></em>. SAGE Publications.
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jpowerj/ppol6805/blob/main/w10/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div></div></footer></body></html>